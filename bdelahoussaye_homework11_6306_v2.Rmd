---
title: "Untitled"
author: "Brandon"
date: "August 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

For question #1 (Warm UP)

First, set the data.table, including unwrapping the matrix and defining the date (index) as a column.



```{r}
install.packages("tidyverse", repos = 'http://cran.us.r-project.org')
library(tidyverse)
install.packages("zoo", repos = 'http://cran.us.r-project.org')
library(zoo)
install.packages("fpp2", repos = 'http://cran.us.r-project.org')
library(fpp2)
install.packages("ggseas", repos = 'http://cran.us.r-project.org')
library(ggseas)

```


```{r}
Date <- as.data.frame(index(EuStockMarkets))
Eu <- as.data.frame(EuStockMarkets)
HW11 <- Date$Eu
Hw11<- cbind(Date,Eu)
HW11_2<- Hw11[-c(3:5)]
```

Next, solid line plot the DAX data against the date data.  PUt in rules/parameters lines around 1997 and color appropriatly.  Finally, decompose the data as a multiplicative model.

```{r}
EuStockMarkets1 <- EuStockMarkets
graph1<- ggplot(HW11_2)
graph1 + geom_line(mapping = aes(x=index(EuStockMarkets1), y=DAX), color="blue") + xlab("Date") + ylab("DAX") + geom_vline(xintercept = 1997, color = "red", linetype = "solid") + geom_vline(xintercept = 1998, color = "red", linetype = "solid")
ggsdc(HW11_2, aes(x=index(EuStockMarkets1), y=DAX), method = "decompose", frequency=4, s.window=8, type="multiplicative")+geom_line(color="blue")+ggtitle("Multiplicative, DAX")+theme_minimal()+xlab("Date") + ylab("DAX") + geom_vline(xintercept = 1997, color = "red", linetype = "solid") + geom_vline(xintercept = 1998, color = "red", linetype = "solid")
```
    
    
Moving along to Temparature Data:

Pull in the data; convert to a usable format (i.e., not a matrix or ts) and remove pre-1990 data.

```{r}

autoplot(maxtemp)
maxtemp1 <- maxtemp[20:46]
forecast <- ses(maxtemp1, h=5)
plot(forecast)
forecast1 <- holt(maxtemp1, h=5, initial = "optimal", damped=TRUE)
plot(forecast1)
summary(forecast)
summary(forecast1)

###AICc for SES = 141.5302 and for holt = 145.5865.  This would generally imply that the SES model produced the better prediction (fit).  However, I observe that the historical was so limited as to produce a flat line prediction under SES.  while the AICc seemed to better, the actual best fit line produced questionable results.
```


Wands

```{r}
install.packages("dygraphs", repos = 'http://cran.us.r-project.org')
library(dygraphs)
setwd("C:/Users/brndn/OneDrive/Documents")
Ollivander <- as.data.frame(read.csv("Unit11timeSeries_Ollivander.csv"))
Gregorovitch <- as.data.frame(read.csv("Unit11timeSeries_Gregorovitch.csv"))
Oll1 <- Ollivander %>%
+ group_by(X1345) %>%
+ mutate(X1.1.1970 = as.Date(X1.1.1970, format = "%d/%m/%Y"))
Greg1 <- Gregorovitch %>%
+ group_by(X1268) %>%
+ mutate(X1.1.1970 = as.Date(X1.1.1970, format = "%d/%m/%Y"))
library(xts)
Greg2 <- as.xts(as.zoo(Greg1, order.by = Greg1$X1.1.1970))
Olli2 <- as.xts(as.zoo(Oll1, order.by = Oll1$X1.1.1970))
colnames(Greg2) <- c("Date","Wand")
colnames(Oll2) <- c("Date","wand")
Wands <- cbind(Greg2,Olli2)
dygraph(Wands) %>% dyRangeSelector(height = 30) dySeries("Greg2", label = "Gregorovitch") %>%
  dySeries("olli2", label = "Ollivander") %>%
  dyOptions(stackedGraph = TRUE) %>%
```

